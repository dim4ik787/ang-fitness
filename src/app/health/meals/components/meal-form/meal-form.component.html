<form [formGroup]="form" class="bg-white divide-y divide-indigo-300">
  <div class="p-5">
    <label class="block">
      <h3 [ngClass]="{ error: required }">
        Meal name<span class="error" *ngIf="required"> is required</span>
      </h3>
      <input
        class="min-w-full mt-3"
        type="text"
        placeholder="e.g. English breakfast"
        formControlName="name" />
    </label>
  </div>

  <div class="p-5">
    <div class="flex justify-between">
      <h3>Food</h3>
      <button
        type="button"
        class="flex items-center ml-auto py-2 px-4 uppercase text-sm"
        (click)="addIngredient()">
        <svg
          class="w-4 h-4 mr-2"
          fill="currentColor"
          viewBox="0 0 20 20"
          xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-9h3a1 1 0 010 2h-3v3a1 1 0 01-2 0v-3H6a1 1 0 010-2h3V6a1 1 0 012 0v3z"
            clip-rule="evenodd"></path>
        </svg>
        Add food
      </button>
    </div>

    <div formArrayName="ingredients" class="relative grid grid-cols-1 sm:grid-cols-2 gap-3 mt-2">
      <label #formRow class="relative" *ngFor="let item of ingredients.controls; index as i">
        <input
          class="block w-full pr-9"
          [formControlName]="i"
          placeholder="e.g. Eggs"
          (keydown.enter)="addIngredient()" />
        <span
          class="remove"
          tabindex="0"
          role="button"
          (keyup.enter)="removeIngredient(i)"
          (click)="removeIngredient(i)"
          >&#10007;</span
        >
      </label>
    </div>
  </div>

  <div class="p-5 flex justify-between">
    <div>
      <button *ngIf="!exists" type="button" (click)="createMeal()">Create meal</button>
      <button *ngIf="exists" type="button" (click)="updateMeal()">Save</button>
      <a class="button border-0 ml-3 p-2" [routerLink]="['../']">Cancel</a>
    </div>
    <div *ngIf="exists">
      <ng-template [ngIf]="toggled">
        <p class="inline-block mr-2">Delete item?</p>
        <button
          class="mr-2 border-red-600 text-red-600 hover:bg-red-800"
          type="button"
          (click)="removeMeal()">
          Yes
        </button>
        <button #no type="button" class="mr-2 border-0" (click)="toggle()">No</button>
      </ng-template>
      <ng-template [ngIf]="!toggled">
        <button
          #delete
          class="border-0 text-red-500 hover:bg-red-500 hover:shadow-md"
          type="button"
          (click)="toggle()">
          Delete
        </button>
      </ng-template>
    </div>
  </div>
</form>
